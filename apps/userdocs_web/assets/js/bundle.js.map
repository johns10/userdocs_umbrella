{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///C:/Users/johnd/OneDrive/Documents/GitHub/userdocs_umbrella/deps/phoenix_html/priv/static/phoenix_html.js","webpack:///./css/app.scss","webpack:///./js/chrome_app.js","webpack:///./js/commands.js","webpack:///./node_modules/nprogress/nprogress.js"],"names":["PolyfillEvent","eventConstructor","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","prototype","Event","buildHiddenInput","name","value","input","createElement","type","handleClick","element","to","getAttribute","method","csrf","form","target","action","style","display","appendChild","body","submit","addEventListener","e","phoenixLinkEvent","dispatchEvent","preventDefault","stopImmediatePropagation","parentNode","message","confirm","chrome","runtime","onMessage","addListener","sender","sendResponse","console","log","tab","url","handle_message","environment","updateEvent","Hooks","fileTransfer","mounted","el","pushEventTo","selectorTransfer","configure","handleEvent","testSelector","storage","local","get","result","payload","activeTabId","jobRunner","thisProcessId","attributes","messageProcessId","process","id","activeWindowId","status","error","element_id","executeStep","thisStepId","messageStepId","steps","CopySelector","srcElement","selector","getElementById","strategy","selectorId","strategyId","selectorField","strategyField","xhr","XMLHttpRequest","responseType","open","onload","documentElement","replaceChild","response","head","csrfToken","querySelector","liveSocket","LiveSocket","Socket","_csrf_token","hooks","info","NProgress","start","done","connect","send","configuration","log_string","handle_job","handle_step","configure_environment","set","job","current_step_id","current_sequence","start_job","updateJobStatus","run_current_step","step","current_step","updateStepStatus","proceed","apply","filter","current_step_index","findIndex","step_type","step_type_name","sequence_id","commands","success","step_element_id","step_element","job_element_id","job_element","failStep","failJob","sendMessage","startStep","sendToBrowser","waitForElement","click","sendToExtension","completeStep","navigate","waitForLoad","fillField","setSize","fullScreenShot","collectElementDimensions","applyAnnotation","clearAnnotations","setSelector","step_index","getElement","size","getBoundingClientRect","annotations","outline","badge","i","active_annotations","length","removeChild","annotation","annotation_type","blur","badge_x","x_orientation","badge_y","y_orientation","labelText","label","color","xOffset","x_offset","yOffset","y_offset","fontSize","font_size","wrapper","rect","x_calcs","L","Math","round","left","toString","M","width","R","right","y_calcs","T","top","bottom","height","B","x","y","justifyContent","alignItems","minHeight","position","zIndex","borderRadius","textAlign","background","textContent","push","outlineColor","thickness","tabs","captureVisibleTab","encoded_image","windows","update","text","timeout","setTimeout","clearInterval","interval","setInterval","r","clearTimeout","next_step","completeJob","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","getSelector","backgroundColor"],"mappings":"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AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;;AAEP;AACA;;AAEA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,gBAAgB;AAChB,KAAK;AACL,gBAAgB;AAChB,KAAK;AACL,gBAAgB;AAChB;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,wC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,CAAC","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/js/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./js/chrome_app.js\");\n","\"use strict\";\n\n(function() {\n  var PolyfillEvent = eventConstructor();\n\n  function eventConstructor() {\n    if (typeof window.CustomEvent === \"function\") return window.CustomEvent;\n    // IE<=9 Support\n    function CustomEvent(event, params) {\n      params = params || {bubbles: false, cancelable: false, detail: undefined};\n      var evt = document.createEvent('CustomEvent');\n      evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n      return evt;\n    }\n    CustomEvent.prototype = window.Event.prototype;\n    return CustomEvent;\n  }\n\n  function buildHiddenInput(name, value) {\n    var input = document.createElement(\"input\");\n    input.type = \"hidden\";\n    input.name = name;\n    input.value = value;\n    return input;\n  }\n\n  function handleClick(element) {\n    var to = element.getAttribute(\"data-to\"),\n        method = buildHiddenInput(\"_method\", element.getAttribute(\"data-method\")),\n        csrf = buildHiddenInput(\"_csrf_token\", element.getAttribute(\"data-csrf\")),\n        form = document.createElement(\"form\"),\n        target = element.getAttribute(\"target\");\n\n    form.method = (element.getAttribute(\"data-method\") === \"get\") ? \"get\" : \"post\";\n    form.action = to;\n    form.style.display = \"hidden\";\n\n    if (target) form.target = target;\n\n    form.appendChild(csrf);\n    form.appendChild(method);\n    document.body.appendChild(form);\n    form.submit();\n  }\n\n  window.addEventListener(\"click\", function(e) {\n    var element = e.target;\n\n    while (element && element.getAttribute) {\n      var phoenixLinkEvent = new PolyfillEvent('phoenix.link.click', {\n        \"bubbles\": true, \"cancelable\": true\n      });\n\n      if (!element.dispatchEvent(phoenixLinkEvent)) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        return false;\n      }\n\n      if (element.getAttribute(\"data-method\")) {\n        handleClick(element);\n        e.preventDefault();\n        return false;\n      } else {\n        element = element.parentNode;\n      }\n    }\n  }, false);\n\n  window.addEventListener('phoenix.link.click', function (e) {\n    var message = e.target.getAttribute(\"data-confirm\");\n    if(message && !window.confirm(message)) {\n      e.preventDefault();\n    }\n  }, false);\n})();\n","// extracted by mini-css-extract-plugin","// We need to import the CSS so that webpack will load it.\r\n// The MiniCssExtractPlugin is used to separate it out into\r\n// its own CSS file.\r\nimport \"../css/app.scss\"\r\n\r\n// webpack automatically bundles all modules in your\r\n// entry points. Those entry points can be configured\r\n// in \"webpack.config.js\".\r\n//\r\n// Import deps with the dep name or local files with a relative path, for example:\r\n//\r\n//     import {Socket} from \"phoenix\"\r\n//     import socket from \"./socket\"\r\n//\r\nimport \"phoenix_html\"\r\nimport {Socket} from \"phoenix\"\r\nimport NProgress from \"nprogress\"\r\nimport {LiveSocket} from \"phoenix_live_view\"\r\nimport {handle_message} from \"./commands.js\"\r\n\r\nchrome.runtime.onMessage.addListener(\r\n\tfunction(message, sender, sendResponse) {\r\n    console.log(\"Extension received message\")\r\n\t\tconsole.log(sender.tab ?\r\n\t\t\t\t\t\t\t\"from a content script:\" + sender.tab.url :\r\n              \"from the extension\");\r\n            \r\n  console.log(\"handling message in the listener\")\r\n  handle_message(message, { environment: 'extension' })\r\n});\r\n\r\nconst updateEvent = new CustomEvent('update', {\r\n  bubbles: false,\r\n  detail: {  }\r\n});\r\n\r\nlet Hooks = {}\r\nHooks.fileTransfer = {\r\n  mounted() {\r\n    this.el.addEventListener(\"message\", e => {\r\n      console.log(\"Got a file\")\r\n      this.pushEventTo('#screenshot-handler-component', \"create_screenshot\", e.detail)\r\n    })\r\n  }\r\n};\r\nHooks.selectorTransfer = {\r\n  mounted() {\r\n    this.el.addEventListener(\"selector\", e => {\r\n      console.log(\"Got a selector\")\r\n      console.log(e.detail)\r\n      this.pushEventTo('#selector-handler', \"transfer_selector\", e.detail)\r\n    })\r\n  }\r\n};\r\nHooks.configure = {\r\n  mounted() {\r\n    this.handleEvent(\"configure\", (message) => {\r\n      handle_message(message, { environment: 'extension' })\r\n    })\r\n  }\r\n};\r\nHooks.testSelector = {\r\n  mounted() {\r\n    this.handleEvent(\"test_selector\", (message) => {\r\n      console.log(\"Testing Selector\");\r\n      console.log(message)\r\n      chrome.storage.local.get(['activeTabId'], function (result) {\r\n        message.payload.activeTabId = result.activeTabId\r\n        handle_message(message, {environment: 'extension'})\r\n      });\r\n    })\r\n  }\r\n};\r\n\r\nHooks.jobRunner = {\r\n  mounted() {\r\n    this.handleEvent(\"message\", (message) =>\r\n    {\r\n      const type = message.type\r\n      if (type === 'process') {\r\n        const thisProcessId =  this.el.attributes[\"phx-value-process-id\"].value\r\n        const messageProcessId = message.payload.process.id\r\n\r\n        if(thisProcessId == messageProcessId) {\r\n          chrome.storage.local.get(['activeTabId', 'activeWindowId'], function (result) {\r\n            message.payload.activeTabId = result.activeTabId\r\n            message.payload.activeWindowId = result.activeWindowId\r\n            handle_message(message, { environment: 'extension' })\r\n          })\r\n        }\r\n      }\r\n    }),\r\n    this.el.addEventListener(\"message\", e => {\r\n      console.log(\"Got a job update\")\r\n      var payload = {\r\n        status: e.detail.status,\r\n        error: e.detail.error\r\n      }\r\n      this.pushEventTo('#' + e.detail.element_id, \"update_status\", payload)\r\n    })\r\n  }\r\n};\r\n\r\nHooks.executeStep = {\r\n  mounted() {\r\n    this.handleEvent(\"message\", (message) =>\r\n    {\r\n      const type = message.type\r\n      if (type === 'step') {\r\n        const thisStepId =  this.el.attributes[\"phx-value-step-id\"].value\r\n        const messageStepId = message.payload.process.steps[0].id\r\n        \r\n        if(thisStepId == messageStepId) {\r\n          chrome.storage.local.get(['activeTabId', 'activeWindowId'], function (result) {\r\n            message.payload.activeTabId = result.activeTabId\r\n            message.payload.activeWindowId = result.activeWindowId\r\n            handle_message(message, { environment: 'extension' })\r\n          })\r\n        }\r\n      }\r\n    }),\r\n    this.el.addEventListener(\"message\", e => {\r\n      console.log(\"Got a step update\")\r\n      console.log(e.detail)\r\n      var payload = {\r\n        status: e.detail.status,\r\n        error: e.detail.error\r\n      }\r\n      this.pushEventTo('#' + e.detail.element_id, \"update_job_status\", payload)\r\n    })\r\n  }\r\n};\r\n\r\nHooks.CopySelector = {\r\n  mounted: function mounted() {\r\n    this.el.addEventListener(\"click\", function (e) {\r\n      console.log(\"Copying Selector\");\r\n      console.log(e.srcElement.attributes)\r\n\r\n      const selector = document.getElementById(\"selector-transfer-field\").value;\r\n      const strategy = document.getElementById(\"strategy-transfer-field\").value;\r\n\r\n      const selectorId = e.srcElement.attributes[\"selector\"].value;\r\n      const strategyId = e.srcElement.attributes[\"strategy\"].value;\r\n\r\n      const selectorField = document.getElementById(selectorId);\r\n      const strategyField = document.getElementById(strategyId);\r\n\r\n      selectorField.value = selector;\r\n      strategyField.value = strategy;\r\n    });\r\n  }\r\n};\r\n\r\nvar xhr = new XMLHttpRequest();\r\nxhr.responseType = 'document';\r\nxhr.open('GET', 'http://localhost:4000', true)\r\nxhr.onload = function(e) {\r\n  document.documentElement.replaceChild(this.response.head, document.head)\r\n  document.documentElement.replaceChild(this.response.body, document.body)\r\n\r\n  console.log(\"hello\")\r\n\r\n  let csrfToken = document.querySelector(\"meta[name='csrf-token']\").getAttribute(\"content\")\r\n  console.log(csrfToken)\r\n  let liveSocket = new LiveSocket(\"ws://localhost:4000/live\", Socket, {\r\n    params: { _csrf_token: csrfToken},\r\n    hooks: Hooks\r\n  })\r\n  \r\n  window.addEventListener(\"phx:page-loading-start\", info => NProgress.start())\r\n  window.addEventListener(\"phx:page-loading-stop\", info => NProgress.done())\r\n  \r\n  liveSocket.connect()\r\n  \r\n  window.liveSocket = liveSocket\r\n}\r\nxhr.send()\r\n\r\n","import { configure } from \"nprogress\"\r\n\r\nfunction handle_message(message, configuration) {\r\n  const log_string = \"Received \" + message.type + \" message.  \"\r\n  console.log(log_string)\r\n  if (message.type == 'process') {\r\n    message.payload.type = 'process'\r\n    handle_job(message.payload, configuration)\r\n  } else if (message.type == 'step') {\r\n    message.payload.type = 'step'\r\n    handle_step(message.payload, configuration)\r\n  } else if (message.type == 'configuration') {\r\n    configure_environment(message.payload)\r\n  }\r\n}\r\n\r\nfunction configure_environment(payload) {\r\n  console.log(\"Current Configuration\") \r\n  chrome.storage.local.set({strategy: payload.strategy}, function() {\r\n    console.log('Selector Strategy is set to ' + payload.strategy.name);\r\n  });\r\n}\r\n\r\nfunction handle_job(job, configuration) {\r\n  const status = job.status\r\n\r\n  const log_string = \"handling job \" + job.id + \" step \" + job.current_step_id + \" sequence \" + job.current_sequence + \" status \" + status\r\n  console.log(log_string)\r\n\r\n  if (status === 'not_started') {\r\n    start_job(job, configuration, handle_job)\r\n    updateJobStatus(job)\r\n  } else if (status == 'running') {\r\n    run_current_step(job, configuration, handle_job)\r\n  } else if (status == 'failed') {\r\n    const step = current_step(job)\r\n    updateStepStatus(step)\r\n    updateJobStatus(job)\r\n  } else if (status == 'complete') {\r\n    const step = current_step(job)\r\n    updateStepStatus(step)\r\n    updateJobStatus(job)\r\n  }\r\n}\r\n\r\nfunction handle_step(job, configuration) {\r\n  const status = job.status\r\n  console.log(\"Handling Step\")\r\n  console.log(job)\r\n  if (status === 'not_started') {\r\n    start_job(job, configuration, handle_step)\r\n  } else if (status == 'running') {\r\n    run_current_step(job, configuration, handle_step)\r\n  } else if (status == 'failed') {\r\n    const step = current_step(job)\r\n    updateStepStatus(step)\r\n  } else if (status == 'complete') {\r\n    const step = current_step(job)\r\n    updateStepStatus(step)\r\n  }\r\n}\r\n\r\nfunction start_job(job, configuration, proceed) {\r\n  const steps = job.process.steps\r\n\r\n  const log_string = \"Starting Job\"\r\n  console.log(log_string)\r\n\r\n  job.status = 'running'\r\n  job.current_step_id = steps[0].id\r\n  job.current_sequence = 1\r\n\r\n  proceed(job, configuration)\r\n}\r\n\r\nfunction run_current_step(job, configuration, proceed) {\r\n  var step = current_step(job)\r\n  var apply = current_sequence(job, step)\r\n\r\n  apply(job, configuration, proceed)\r\n}\r\n\r\nfunction current_step(job) {\r\n  const steps = job.process.steps\r\n  return steps.filter(step => step.id === job.current_step_id)[0]\r\n}\r\n\r\nfunction current_step_index(job) {\r\n  const steps = job.process.steps\r\n  return steps.findIndex(step => step.id === job.current_step_id)\r\n}\r\n\r\nfunction current_sequence(job, step) {\r\n  const log_string = \"Locating current sequence of \" + step.step_type.name\r\n  console.log(step)\r\n  const step_type_name = step.step_type.name\r\n  const sequence_id = job.current_sequence\r\n\r\n  return commands()[step_type_name][sequence_id]\r\n}\r\n\r\nfunction success(job, configuration, proceed) { \r\n  console.log(\"Step Succeeded\")\r\n  job.current_sequence = job.current_sequence + 1\r\n  proceed(job, configuration)\r\n}\r\n\r\nfunction updateStepStatus(step) {\r\n  // # TODO: Remove this convention and replace with something I pass in\r\n  console.log(\"Updating step status\")\r\n  const step_element_id = \"step-\" + step.id + \"-runner\"\r\n  var step_element = document.getElementById(step_element_id)\r\n  \r\n  step.element_id = step_element_id\r\n\r\n  console.log(step)\r\n\r\n  step_element.dispatchEvent(new CustomEvent(\"message\", {\r\n    bubbles: false,\r\n    detail: step\r\n  }))\r\n}\r\n\r\nfunction updateJobStatus(job) {\r\n  // # TODO: Remove this convention and replace with something I pass in\r\n  console.log(\"Updating Job Status\")\r\n  const job_element_id = \"process-\" + job.process.id + \"-runner\"\r\n  var job_element = document.getElementById(job_element_id)\r\n\r\n  job.element_id = job_element_id\r\n\r\n  job_element.dispatchEvent(new CustomEvent(\"message\", {\r\n    bubbles: false,\r\n    detail: job\r\n  }))\r\n}\r\n\r\nfunction failStep(job, error, configuration, proceed) {\r\n  console.log(\"Step Failed\")\r\n  console.log(error)\r\n  var step = current_step(job)\r\n  step.status = \"failed\"\r\n  step.error = error\r\n\r\n  if(configuration.environment == 'extension') {\r\n    console.log(\"In Extension\")\r\n    failJob(job, \"Step \" + step.id + \" failed\", configuration, proceed)\r\n  } else if (configuration.environment == 'browser') {\r\n    console.log(\"In Browser\")\r\n    failJob(job, \"Step \" + step.id + \" failed\", configuration, proceed)\r\n  }\r\n\r\n}\r\n\r\nfunction failJob(job, error, configuration, proceed) {\r\n  console.log(\"Job Failed\")\r\n  job.status = \"failed\"\r\n  job.error = error\r\n\r\n  if(configuration.environment == 'extension') {\r\n    proceed(job, configuration)\r\n  } else if (configuration.environment == 'browser') {\r\n    chrome.runtime.sendMessage(job)\r\n  }\r\n}\r\n\r\nfunction commands() {\r\n  return {\r\n    \"Click\": {\r\n      1: startStep,\r\n      2: sendToBrowser,\r\n      3: waitForElement,\r\n      4: click,\r\n      5: sendToExtension,\r\n      6: completeStep\r\n    },\r\n    \"Navigate\": {\r\n      1: startStep,\r\n      2: navigate,\r\n      3: waitForLoad,\r\n      4: completeStep\r\n    },\r\n    \"Fill Field\": {\r\n      1: startStep,\r\n      2: sendToBrowser,\r\n      3: waitForElement,\r\n      4: fillField,\r\n      5: sendToExtension,\r\n      6: completeStep\r\n    },\r\n    \"Set Size Explicit\": {\r\n      1: startStep,\r\n      2: setSize,\r\n      3: completeStep\r\n    },\r\n    \"Full Screen Screenshot\": {\r\n      1: startStep,\r\n      2: fullScreenShot,\r\n      3: completeStep\r\n    },\r\n    \"Element Screenshot\": {\r\n      1: startStep,\r\n      2: sendToBrowser,\r\n      3: collectElementDimensions,\r\n      4: sendToExtension,\r\n      5: fullScreenShot,\r\n      6: completeStep\r\n    },\r\n    \"Apply Annotation\": {\r\n      1: startStep,\r\n      2: sendToBrowser,\r\n      3: waitForElement,\r\n      4: applyAnnotation,\r\n      5: sendToExtension,\r\n      6: completeStep\r\n    },\r\n    \"Clear Annotations\": {\r\n      1: startStep,\r\n      2: sendToBrowser,\r\n      3: clearAnnotations,\r\n      4: sendToExtension,\r\n      5: completeStep\r\n    },\r\n    \"Set Selector\": {\r\n      1: sendToExtension,\r\n      2: setSelector\r\n    },\r\n    \"Test Selector\": {\r\n      1: sendToBrowser,\r\n      2: testSelector\r\n    }\r\n  }\r\n}\r\n\r\nfunction collectElementDimensions(job, configuration, proceed) {\r\n  const step = current_step(job)\r\n  const step_index = current_step_index(job)\r\n\r\n  const selector = step.element.selector\r\n  const strategy = step.element.strategy\r\n  const element = getElement(strategy, selector)\r\n\r\n  step.element.size = element.getBoundingClientRect()\r\n  job.process.steps[step_index] = step\r\n  \r\n  success(job, configuration, proceed)\r\n}\r\n\r\nfunction annotations() {\r\n  return {\r\n    \"Outline\": outline,\r\n    \"Badge\": badge\r\n  }\r\n}\r\n\r\nfunction clearAnnotations(job, configuration, proceed) {\r\n  const step = current_step(job)\r\n\r\n  try {\r\n    for (let i = 0; i < window.active_annotations.length; i++) {\r\n      document.body.removeChild(window.active_annotations[i]);\r\n    }\r\n    window.active_annotations = []\r\n    success(job, configuration, proceed)\r\n  } catch(error) {\r\n    step.status = \"failed\"\r\n    step.error = error\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction applyAnnotation(job, configuration, proceed) {\r\n  const step = current_step(job)\r\n  const name = step.annotation.annotation_type.name\r\n  console.log(\"applying annotation\")\r\n  /*\r\n  console.log(step)\r\n  console.log(step.annotation.annotation_type.name)\r\n  console.log(annotations())\r\n  */\r\n  var apply = annotations()[name]\r\n  try {\r\n    apply(job, configuration, proceed)\r\n    success(job, configuration, proceed)\r\n  } catch(error) {\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction blur(job, configuration) {\r\n\r\n}\r\n\r\nfunction badge(job, configuration, proceed) {\r\n  const step = current_step(job)\r\n  const selector = step.element.selector\r\n  const strategy = step.element.strategy\r\n  const element = getElement(strategy, selector)\r\n\r\n  var badge_x = step.annotation.x_orientation\r\n  var badge_y = step.annotation.y_orientation\r\n  var size = step.annotation.size\r\n  var labelText = step.annotation.label\r\n  var color = step.annotation.color\r\n  var xOffset = step.annotation.x_offset\r\n  var yOffset = step.annotation.y_offset\r\n  var fontSize = step.font_size;\r\n\r\n  var wrapper = document.createElement('div');\r\n  var badge = document.createElement('span');\r\n  var label = document.createElement('span');\r\n\r\n  const rect = element.getBoundingClientRect();\r\n\r\n  const x_calcs = {\r\n    L: Math.round(rect.left - size + xOffset).toString() + 'px',\r\n    M: Math.round(rect.left + rect.width/2 - size + xOffset).toString() + 'px',\r\n    R: Math.round(rect.right - size + xOffset).toString() + 'px'\r\n  }\r\n  const y_calcs = {\r\n    T: Math.round(rect.top - size + yOffset).toString() + 'px',\r\n    M: Math.round(rect.bottom - rect.height/2 - size + yOffset).toString() + 'px',\r\n    B: Math.round(rect.bottom - size + yOffset).toString() + 'px'\r\n  }\r\n\r\n  const x = x_calcs[badge_x]\r\n  const y = y_calcs[badge_y]\r\n\r\n  wrapper.style.display = 'static';\r\n  wrapper.style.justifyContent = 'center';\r\n  wrapper.style.alignItems = 'center';\r\n  wrapper.style.minHeight = '';\r\n  wrapper.style.position = 'fixed';\r\n  wrapper.style.top = y;\r\n  wrapper.style.left = x;\r\n  wrapper.style.zIndex = 999999;\r\n\r\n  badge.style.position = 'relative';\r\n  badge.style.display = 'inline-table';\r\n  badge.style.width = (2 * size).toString() + 'px';\r\n  badge.style.height = (2 * size).toString() + 'px';\r\n  badge.style.borderRadius = '50%';\r\n  badge.style.fontSize = fontSize.toString() + 'px';\r\n  badge.style.textAlign = 'center';\r\n  badge.style.background = color;\r\n\r\n  label.style.position = 'relative';\r\n  label.style.top = ((size * 2 - fontSize) / 2).toString() + 'px';\r\n  label.textContent = labelText;\r\n  label.style.color = 'white';\r\n\r\n  try {\r\n    document.body.appendChild(wrapper);\r\n    wrapper.appendChild(badge); \r\n    badge.appendChild(label);\r\n    window.active_annotations.push(wrapper);\r\n  } catch(error) {\r\n    step.status = \"failed\"\r\n    step.error = error\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction outline(job, configuration, proceed) {\r\n  const step = current_step(job)\r\n  const selector = step.element.selector\r\n  const strategy = step.element.strategy\r\n  const outlineColor = step.annotation.color\r\n  const thickness = step.annotation.thickness + 'px';\r\n\r\n  const element = getElement(strategy, selector)\r\n\r\n  const rect = element.getBoundingClientRect();\r\n  const outline = document.createElement('div');\r\n  \r\n  outline.style.position = 'fixed';\r\n  outline.style.width = Math.round(rect.width).toString() + 'px'\r\n  outline.style.height = Math.round(rect.height).toString() + 'px'\r\n  outline.style.outline = outlineColor + ' solid ' + thickness;\r\n  outline.style.top = Math.round(rect.top).toString() + 'px';\r\n  outline.style.left = Math.round(rect.left).toString() + 'px';\r\n  outline.style.zIndex = 99999;\r\n\r\n  try {\r\n    document.body.appendChild(outline)\r\n    window.active_annotations.push(outline)\r\n  } catch(error) {\r\n    step.status = \"failed\"\r\n    step.error = error\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction fullScreenShot(job, configuration, proceed) {\r\n  const activeWindowId = job.activeWindowId\r\n  const step = current_step(job)\r\n\r\n  console.log(\"Taking a full screen screenshot\")\r\n  try {\r\n    chrome.tabs.captureVisibleTab(activeWindowId, function(result) {\r\n      console.log(\"Finished capturing Result\")\r\n      console.log(result)\r\n      if(result) {\r\n        step.encoded_image = result\r\n        document\r\n          .getElementById(\"screenshot-handler-component\")\r\n          .dispatchEvent(new CustomEvent(\"message\", {\r\n            bubbles: false,\r\n            detail: step\r\n          }))\r\n        success(job, configuration, proceed)\r\n      } else if(result == undefined) {\r\n        step.status = \"failed\"\r\n        const error = \"No Screenshot Returned\"\r\n        step.error = error\r\n        failStep(job, error, configuration, proceed)\r\n      }\r\n    })\r\n  } catch(error) {\r\n    step.status = \"failed\"\r\n    step.error = error\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction setSize(job, configuration, proceed) {\r\n  const activeWindowId = job.activeWindowId\r\n  const step = current_step(job)\r\n  const payload = {\r\n    width: step.width,\r\n    height: step.height\r\n  }\r\n\r\n  console.log(\"Setting size in \" + activeWindowId)\r\n  console.log(payload)\r\n\r\n  try {\r\n    chrome.windows.update(activeWindowId, payload)\r\n    success(job, configuration, proceed)\r\n  } catch(error) {\r\n    step.status = \"failed\"\r\n    step.error = error\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n\r\n}\r\n\r\nfunction navigate(job, configuration, proceed) {\r\n  const activeTabId = job.activeTabId\r\n  const step = current_step(job)\r\n\r\n  const payload = {\r\n    url: step.url\r\n  }\r\n\r\n  const log_string = \"Executing a navigate step to \" + activeTabId\r\n  console.log(log_string)\r\n  \r\n  try {\r\n    chrome.tabs.update(activeTabId, payload, function(result) {\r\n      console.log(\"Triggered Navigation\")\r\n      success(job, configuration, proceed)\r\n    })\r\n  } catch (error) {\r\n    step.status = \"failed\"\r\n    step.error = error\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction fillField(job, configuration, proceed) {\r\n  console.log(\"Filling a field\")\r\n  const step = current_step(job)\r\n  const selector = step.element.selector\r\n  const strategy = step.element.strategy\r\n  const text = step.text\r\n  const element = getElement(strategy, selector)\r\n  const event = new Event('input', { bubbles: true })\r\n\r\n  try {\r\n    console.log(\"Writing to field\")  \r\n    element.value = text\r\n    element.dispatchEvent(event)\r\n    success(job, configuration, proceed)\r\n  } catch (error) {\r\n    step.status = \"failed\"\r\n    step.error = error\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction waitForLoad(job, configuration, proceed) {\r\n  console.log(\"waiting for load\")\r\n  const activeTabId = job.activeTabId\r\n\r\n  var timeout = setTimeout(function(){ \r\n    clearInterval(interval)\r\n    console.log(\"Not found\")\r\n    failStep(job, \"Page not Loaded\", configuration, proceed)\r\n   }, 3000);\r\n\r\n  var interval = setInterval(function(){\r\n    chrome.tabs.get(activeTabId, function(r) {\r\n      if(r.status == 'complete') {\r\n        clearTimeout(timeout)\r\n        clearInterval(interval)\r\n        console.log(\"Page Loaded\")\r\n        success(job, configuration, proceed)\r\n      }\r\n    })\r\n  }, 100);\r\n}\r\n\r\n\r\nfunction startStep(job, configuration, proceed) {\r\n  var step = current_step(job)\r\n  // TODO: This is a convention.  Find a cleaner way to pass from backend\r\n  const step_element_id = \"step-\" + step.id + \"-runner\"\r\n  const step_element = document.getElementById(step_element_id)\r\n  const step_index = current_step_index(job)\r\n  const steps = job.process.steps\r\n\r\n  console.log(\"Starting a \" + step.type + \" step\")\r\n\r\n  step.status = \"running\"\r\n  step.element_id = step_element_id\r\n\r\n  try {\r\n    step_element.dispatchEvent(new CustomEvent(\"message\", {\r\n      bubbles: false,\r\n      detail: step\r\n    }))\r\n    steps[step_index] = step\r\n    success(job, configuration, proceed)\r\n  } catch(error) {\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction completeStep(job, configuration, proceed) {\r\n  var step = current_step(job)\r\n  const step_index = current_step_index(job)\r\n  // TODO: This is a convention.  Find a cleaner way to pass from backend\r\n  const step_element_id = \"step-\" + step.id + \"-runner\"\r\n  const step_element = document.getElementById(step_element_id)\r\n  const event = new CustomEvent(\"message\", {bubbles: false, detail: step})\r\n  const steps = job.process.steps\r\n\r\n  const log_string = \"Completing step \" + step_element_id\r\n  console.log(log_string)\r\n\r\n  step.status = \"complete\"\r\n\r\n  try {\r\n    step_element.dispatchEvent(event)\r\n    var next_step = steps[step_index + 1]\r\n    console.log(next_step)\r\n    if (next_step) {\r\n      // If there's another step, we update and call handle_job\r\n      job.current_step_id = next_step.id\r\n      job.current_sequence = 1\r\n      proceed(job, configuration)\r\n    } else {\r\n      // If there's not, we're going to complete the job\r\n      completeJob(job, configuration, proceed)\r\n    }\r\n  } catch(error) {\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction completeJob(job, configuration, proceed) {\r\n  job.status = 'complete'\r\n  proceed(job, configuration)\r\n}\r\n\r\n\r\nfunction sendToBrowser(job, configuration, proceed) {\r\n  console.log(\"Send to browser\")\r\n  if(configuration.environment == 'extension') {\r\n    console.log(\"Sending to browser\")\r\n    // console.log(job.activeTabId)\r\n    const message = {\r\n      type: job.type,\r\n      payload: job\r\n    }\r\n    try {\r\n      job.current_sequence = job.current_sequence + 1\r\n      chrome.tabs.sendMessage(job.activeTabId, message)\r\n      console.log(\"Step sent to browser\")\r\n    } catch(error) {\r\n      failStep(job, error, configuration, proceed)\r\n    }\r\n  } else {\r\n    success(job, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction sendToExtension(job, configuration, proceed) {\r\n  console.log(\"Send to extension\")\r\n  if(configuration.environment == 'browser') {\r\n    console.log(\"sending to browser\")\r\n    const message = {\r\n      type: job.type,\r\n      payload: job\r\n    }\r\n\r\n    try {\r\n      job.current_sequence = job.current_sequence + 1\r\n      chrome.runtime.sendMessage(message)\r\n      console.log(\"Sent to Extension\") \r\n    } catch(error) {\r\n      failStep(job, error, configuration, proceed)\r\n    } \r\n  } else {\r\n    success(job, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction waitForElement(job, configuration, proceed) {\r\n  var step = current_step(job)\r\n\r\n  const selector = step.element.selector\r\n  const strategy = step.element.strategy\r\n\r\n  console.log(strategy)\r\n\r\n  var element = null\r\n  \r\n  const log_string = \"Waiting for element, strategy: \" + strategy.name + \" selector: \" + selector\r\n  console.log(log_string)\r\n\r\n  var timeout = setTimeout(function(){ \r\n    clearInterval(interval)\r\n    failStep(job, \"Element not found\", configuration, proceed)\r\n   }, 3000);\r\n  var interval = setInterval(function(){\r\n    element = getElement(strategy, selector)\r\n    if(element) {\r\n      step.status = \"running_prechecks\"\r\n      clearTimeout(timeout)\r\n      clearInterval(interval)\r\n      console.log(\"found\")\r\n      success(job, configuration, proceed)\r\n    }\r\n  }, 100);\r\n}\r\n\r\nfunction click(job, configuration, proceed) {\r\n  const step = current_step(job)\r\n  const selector = step.element.selector\r\n  const strategy = step.element.strategy\r\n\r\n  try {\r\n    console.log(\"Getting element\")\r\n    getElement(strategy, selector)\r\n      .click()\r\n    success(job, configuration, proceed)\r\n  } catch (error) {\r\n    step.status = \"failed\"\r\n    step.error = error\r\n    failStep(job, error, configuration, proceed)\r\n  }\r\n}\r\n\r\nfunction getElement(strategy, selector) {\r\n  console.log(\"Getting Element with strategy \" + strategy.name + \" and Selector \" + selector)\r\n  var element = null\r\n\r\n  if(strategy.name == 'xpath') {\r\n    element = document.evaluate(\r\n      selector, \r\n      document, \r\n      null, \r\n      XPathResult.FIRST_ORDERED_NODE_TYPE, \r\n      null).singleNodeValue\r\n  } else if (strategy.name == 'id') {\r\n    element = document.getElementById(selector)\r\n  } else if (strategy.name == 'css') {\r\n    element = document.querySelector(selector)\r\n  }\r\n  return element\r\n}\r\n\r\nfunction getSelector(job, configuration, proceed) {\r\n  console.log(\"Getting Selector\")\r\n  success(job, configuration, proceed)\r\n}\r\n\r\nfunction setSelector(job, configuration, proceed) {\r\n  const step = current_step(job)\r\n\r\n  const payload = {\r\n    selector: step.selector,\r\n    strategy: step.strategy\r\n  }\r\n\r\n  console.log(\"Setting Strategy to \" + payload.strategy + \" and Selector to \" + payload.selector)\r\n\r\n  document\r\n    .getElementById(\"selector-handler\")\r\n    .dispatchEvent(new CustomEvent(\"selector\", {\r\n      bubbles: false,\r\n      detail: payload\r\n    }))\r\n\r\n  success(job, configuration, proceed)\r\n}\r\n\r\nfunction testSelector(job, configuration, proceed) {\r\n  const step = current_step(job)\r\n  const selector = step.selector\r\n  const strategy = step.strategy\r\n  console.log(\"22 Testing \" + strategy + \" Selector \" + selector)\r\n  console.log(step)\r\n\r\n  if (strategy.name === 'xpath') {\r\n    console.log(\"xpath\")\r\n\r\n    document\r\n      .evaluate(selector, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null)\r\n      .singleNodeValue\r\n      .style\r\n      .backgroundColor = \"#FDFF47\"\r\n\r\n  } else if (strategy.name === 'css') {\r\n\r\n    document\r\n      .querySelector(selector)\r\n      .style\r\n      .backgroundColor = \"#FDFF47\"\r\n  }\r\n}\r\n\r\nexport {handle_message}","/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress\n * @license MIT */\n\n;(function(root, factory) {\n\n  if (typeof define === 'function' && define.amd) {\n    define(factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.NProgress = factory();\n  }\n\n})(this, function() {\n  var NProgress = {};\n\n  NProgress.version = '0.2.0';\n\n  var Settings = NProgress.settings = {\n    minimum: 0.08,\n    easing: 'ease',\n    positionUsing: '',\n    speed: 200,\n    trickle: true,\n    trickleRate: 0.02,\n    trickleSpeed: 800,\n    showSpinner: true,\n    barSelector: '[role=\"bar\"]',\n    spinnerSelector: '[role=\"spinner\"]',\n    parent: 'body',\n    template: '<div class=\"bar\" role=\"bar\"><div class=\"peg\"></div></div><div class=\"spinner\" role=\"spinner\"><div class=\"spinner-icon\"></div></div>'\n  };\n\n  /**\n   * Updates configuration.\n   *\n   *     NProgress.configure({\n   *       minimum: 0.1\n   *     });\n   */\n  NProgress.configure = function(options) {\n    var key, value;\n    for (key in options) {\n      value = options[key];\n      if (value !== undefined && options.hasOwnProperty(key)) Settings[key] = value;\n    }\n\n    return this;\n  };\n\n  /**\n   * Last number.\n   */\n\n  NProgress.status = null;\n\n  /**\n   * Sets the progress bar status, where `n` is a number from `0.0` to `1.0`.\n   *\n   *     NProgress.set(0.4);\n   *     NProgress.set(1.0);\n   */\n\n  NProgress.set = function(n) {\n    var started = NProgress.isStarted();\n\n    n = clamp(n, Settings.minimum, 1);\n    NProgress.status = (n === 1 ? null : n);\n\n    var progress = NProgress.render(!started),\n        bar      = progress.querySelector(Settings.barSelector),\n        speed    = Settings.speed,\n        ease     = Settings.easing;\n\n    progress.offsetWidth; /* Repaint */\n\n    queue(function(next) {\n      // Set positionUsing if it hasn't already been set\n      if (Settings.positionUsing === '') Settings.positionUsing = NProgress.getPositioningCSS();\n\n      // Add transition\n      css(bar, barPositionCSS(n, speed, ease));\n\n      if (n === 1) {\n        // Fade out\n        css(progress, { \n          transition: 'none', \n          opacity: 1 \n        });\n        progress.offsetWidth; /* Repaint */\n\n        setTimeout(function() {\n          css(progress, { \n            transition: 'all ' + speed + 'ms linear', \n            opacity: 0 \n          });\n          setTimeout(function() {\n            NProgress.remove();\n            next();\n          }, speed);\n        }, speed);\n      } else {\n        setTimeout(next, speed);\n      }\n    });\n\n    return this;\n  };\n\n  NProgress.isStarted = function() {\n    return typeof NProgress.status === 'number';\n  };\n\n  /**\n   * Shows the progress bar.\n   * This is the same as setting the status to 0%, except that it doesn't go backwards.\n   *\n   *     NProgress.start();\n   *\n   */\n  NProgress.start = function() {\n    if (!NProgress.status) NProgress.set(0);\n\n    var work = function() {\n      setTimeout(function() {\n        if (!NProgress.status) return;\n        NProgress.trickle();\n        work();\n      }, Settings.trickleSpeed);\n    };\n\n    if (Settings.trickle) work();\n\n    return this;\n  };\n\n  /**\n   * Hides the progress bar.\n   * This is the *sort of* the same as setting the status to 100%, with the\n   * difference being `done()` makes some placebo effect of some realistic motion.\n   *\n   *     NProgress.done();\n   *\n   * If `true` is passed, it will show the progress bar even if its hidden.\n   *\n   *     NProgress.done(true);\n   */\n\n  NProgress.done = function(force) {\n    if (!force && !NProgress.status) return this;\n\n    return NProgress.inc(0.3 + 0.5 * Math.random()).set(1);\n  };\n\n  /**\n   * Increments by a random amount.\n   */\n\n  NProgress.inc = function(amount) {\n    var n = NProgress.status;\n\n    if (!n) {\n      return NProgress.start();\n    } else {\n      if (typeof amount !== 'number') {\n        amount = (1 - n) * clamp(Math.random() * n, 0.1, 0.95);\n      }\n\n      n = clamp(n + amount, 0, 0.994);\n      return NProgress.set(n);\n    }\n  };\n\n  NProgress.trickle = function() {\n    return NProgress.inc(Math.random() * Settings.trickleRate);\n  };\n\n  /**\n   * Waits for all supplied jQuery promises and\n   * increases the progress as the promises resolve.\n   *\n   * @param $promise jQUery Promise\n   */\n  (function() {\n    var initial = 0, current = 0;\n\n    NProgress.promise = function($promise) {\n      if (!$promise || $promise.state() === \"resolved\") {\n        return this;\n      }\n\n      if (current === 0) {\n        NProgress.start();\n      }\n\n      initial++;\n      current++;\n\n      $promise.always(function() {\n        current--;\n        if (current === 0) {\n            initial = 0;\n            NProgress.done();\n        } else {\n            NProgress.set((initial - current) / initial);\n        }\n      });\n\n      return this;\n    };\n\n  })();\n\n  /**\n   * (Internal) renders the progress bar markup based on the `template`\n   * setting.\n   */\n\n  NProgress.render = function(fromStart) {\n    if (NProgress.isRendered()) return document.getElementById('nprogress');\n\n    addClass(document.documentElement, 'nprogress-busy');\n    \n    var progress = document.createElement('div');\n    progress.id = 'nprogress';\n    progress.innerHTML = Settings.template;\n\n    var bar      = progress.querySelector(Settings.barSelector),\n        perc     = fromStart ? '-100' : toBarPerc(NProgress.status || 0),\n        parent   = document.querySelector(Settings.parent),\n        spinner;\n    \n    css(bar, {\n      transition: 'all 0 linear',\n      transform: 'translate3d(' + perc + '%,0,0)'\n    });\n\n    if (!Settings.showSpinner) {\n      spinner = progress.querySelector(Settings.spinnerSelector);\n      spinner && removeElement(spinner);\n    }\n\n    if (parent != document.body) {\n      addClass(parent, 'nprogress-custom-parent');\n    }\n\n    parent.appendChild(progress);\n    return progress;\n  };\n\n  /**\n   * Removes the element. Opposite of render().\n   */\n\n  NProgress.remove = function() {\n    removeClass(document.documentElement, 'nprogress-busy');\n    removeClass(document.querySelector(Settings.parent), 'nprogress-custom-parent');\n    var progress = document.getElementById('nprogress');\n    progress && removeElement(progress);\n  };\n\n  /**\n   * Checks if the progress bar is rendered.\n   */\n\n  NProgress.isRendered = function() {\n    return !!document.getElementById('nprogress');\n  };\n\n  /**\n   * Determine which positioning CSS rule to use.\n   */\n\n  NProgress.getPositioningCSS = function() {\n    // Sniff on document.body.style\n    var bodyStyle = document.body.style;\n\n    // Sniff prefixes\n    var vendorPrefix = ('WebkitTransform' in bodyStyle) ? 'Webkit' :\n                       ('MozTransform' in bodyStyle) ? 'Moz' :\n                       ('msTransform' in bodyStyle) ? 'ms' :\n                       ('OTransform' in bodyStyle) ? 'O' : '';\n\n    if (vendorPrefix + 'Perspective' in bodyStyle) {\n      // Modern browsers with 3D support, e.g. Webkit, IE10\n      return 'translate3d';\n    } else if (vendorPrefix + 'Transform' in bodyStyle) {\n      // Browsers without 3D support, e.g. IE9\n      return 'translate';\n    } else {\n      // Browsers without translate() support, e.g. IE7-8\n      return 'margin';\n    }\n  };\n\n  /**\n   * Helpers\n   */\n\n  function clamp(n, min, max) {\n    if (n < min) return min;\n    if (n > max) return max;\n    return n;\n  }\n\n  /**\n   * (Internal) converts a percentage (`0..1`) to a bar translateX\n   * percentage (`-100%..0%`).\n   */\n\n  function toBarPerc(n) {\n    return (-1 + n) * 100;\n  }\n\n\n  /**\n   * (Internal) returns the correct CSS for changing the bar's\n   * position given an n percentage, and speed and ease from Settings\n   */\n\n  function barPositionCSS(n, speed, ease) {\n    var barCSS;\n\n    if (Settings.positionUsing === 'translate3d') {\n      barCSS = { transform: 'translate3d('+toBarPerc(n)+'%,0,0)' };\n    } else if (Settings.positionUsing === 'translate') {\n      barCSS = { transform: 'translate('+toBarPerc(n)+'%,0)' };\n    } else {\n      barCSS = { 'margin-left': toBarPerc(n)+'%' };\n    }\n\n    barCSS.transition = 'all '+speed+'ms '+ease;\n\n    return barCSS;\n  }\n\n  /**\n   * (Internal) Queues a function to be executed.\n   */\n\n  var queue = (function() {\n    var pending = [];\n    \n    function next() {\n      var fn = pending.shift();\n      if (fn) {\n        fn(next);\n      }\n    }\n\n    return function(fn) {\n      pending.push(fn);\n      if (pending.length == 1) next();\n    };\n  })();\n\n  /**\n   * (Internal) Applies css properties to an element, similar to the jQuery \n   * css method.\n   *\n   * While this helper does assist with vendor prefixed property names, it \n   * does not perform any manipulation of values prior to setting styles.\n   */\n\n  var css = (function() {\n    var cssPrefixes = [ 'Webkit', 'O', 'Moz', 'ms' ],\n        cssProps    = {};\n\n    function camelCase(string) {\n      return string.replace(/^-ms-/, 'ms-').replace(/-([\\da-z])/gi, function(match, letter) {\n        return letter.toUpperCase();\n      });\n    }\n\n    function getVendorProp(name) {\n      var style = document.body.style;\n      if (name in style) return name;\n\n      var i = cssPrefixes.length,\n          capName = name.charAt(0).toUpperCase() + name.slice(1),\n          vendorName;\n      while (i--) {\n        vendorName = cssPrefixes[i] + capName;\n        if (vendorName in style) return vendorName;\n      }\n\n      return name;\n    }\n\n    function getStyleProp(name) {\n      name = camelCase(name);\n      return cssProps[name] || (cssProps[name] = getVendorProp(name));\n    }\n\n    function applyCss(element, prop, value) {\n      prop = getStyleProp(prop);\n      element.style[prop] = value;\n    }\n\n    return function(element, properties) {\n      var args = arguments,\n          prop, \n          value;\n\n      if (args.length == 2) {\n        for (prop in properties) {\n          value = properties[prop];\n          if (value !== undefined && properties.hasOwnProperty(prop)) applyCss(element, prop, value);\n        }\n      } else {\n        applyCss(element, args[1], args[2]);\n      }\n    }\n  })();\n\n  /**\n   * (Internal) Determines if an element or space separated list of class names contains a class name.\n   */\n\n  function hasClass(element, name) {\n    var list = typeof element == 'string' ? element : classList(element);\n    return list.indexOf(' ' + name + ' ') >= 0;\n  }\n\n  /**\n   * (Internal) Adds a class to an element.\n   */\n\n  function addClass(element, name) {\n    var oldList = classList(element),\n        newList = oldList + name;\n\n    if (hasClass(oldList, name)) return; \n\n    // Trim the opening space.\n    element.className = newList.substring(1);\n  }\n\n  /**\n   * (Internal) Removes a class from an element.\n   */\n\n  function removeClass(element, name) {\n    var oldList = classList(element),\n        newList;\n\n    if (!hasClass(element, name)) return;\n\n    // Replace the class name.\n    newList = oldList.replace(' ' + name + ' ', ' ');\n\n    // Trim the opening and closing spaces.\n    element.className = newList.substring(1, newList.length - 1);\n  }\n\n  /**\n   * (Internal) Gets a space separated list of the class names on the element. \n   * The list is wrapped with a single space on each end to facilitate finding \n   * matches within the list.\n   */\n\n  function classList(element) {\n    return (' ' + (element.className || '') + ' ').replace(/\\s+/gi, ' ');\n  }\n\n  /**\n   * (Internal) Removes an element from the DOM.\n   */\n\n  function removeElement(element) {\n    element && element.parentNode && element.parentNode.removeChild(element);\n  }\n\n  return NProgress;\n});\n\n"],"sourceRoot":""}